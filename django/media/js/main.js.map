{"version":3,"sources":["webpack:///webpack/bootstrap 69cc8c9169ad7f81980e","webpack:///./src/js/main.js","webpack:///./node_modules/node-js-marker-clusterer/src/markerclusterer.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/google-maps/lib/Google.js"],"names":["map","markers","markerclusterer","activeMarker","lastTouch","MarkerClusterer","require","google","timeoutControlFade","initialZoom","initialLatitude","initialLongitude","currentState","currentCity","GoogleMapsLoader","KEY","fillSelect","type","url","xhr","XMLHttpRequest","onload","data","JSON","parse","responseText","select","document","querySelector","option","i","length","insertAdjacentHTML","pk","stringify","split","join","name","onerror","console","log","open","responseType","send","addMarkerCluster","clusterStyles","textColor","height","width","mcOptions","gridSize","styles","maxZoom","changeImage","direction","index","parseInt","dataset","id","newIndex","maps","event","trigger","imageTouchStart","timeStamp","changedTouches","pageX","pageY","imageTouchEnd","distX","timeDiff","minSwipe","addMarkerClick","marker","addListener","classList","add","remove","controls","querySelectorAll","control","window","location","href","indexOf","contentType","innerHTML","galleryImage","addEventListener","description","panTo","position","setOptions","keyboardShortcuts","fadeControls","clearTimeout","setTimeout","addMarkers","placemarks","responseXML","documentElement","getElementsByTagName","forEach","call","element","textContent","desc","pos","LatLng","latitude","longitude","title","address","city","state","Marker","icon","push","init","latlng","myOptions","zoom","center","mapTypeId","MapTypeId","SATELLITE","Map","getElementById","enterFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","getCookie","cookieValue","cookie","cookies","trim","substring","decodeURIComponent","currentTarget","contains","focus","buttons","button","confirm","csrftoken","isNaN","alert","setRequestHeader","selects","options","selectedIndex","value","selected","dispatchEvent","Event","cities","cityData","style","display","sw","max_latitude","max_longitude","ne","min_latitude","min_longitude","LatLngBounds","bounds","extend","fitBounds","e","setCenter","setZoom","keyCode","fullScreenChange","load","g"],"mappings":"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ACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,qBAAqB;AAC9C;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,2BAA2B;AACxC;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,2BAA2B;AACvC,YAAY,OAAO;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,2BAA2B;AACtC,WAAW,SAAS;AACpB;AACA;AACA,yBAAyB,qBAAqB;AAC9C;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,sBAAsB,sBAAsB;AAC5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,SAAS;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,2BAA2B;AACtC,WAAW,SAAS;AACpB;AACA;AACA;;AAEA,yBAAyB,qBAAqB;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC,YAAY,yBAAyB;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,yBAAyB;AACpC,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA,0BAA0B,6BAA6B;AACvD;AACA;;AAEA;AACA,yBAAyB,2BAA2B;AACpD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B,0BAA0B;AACtD;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,0BAA0B,6BAA6B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,yBAAyB,2BAA2B;AACpD;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,GAAG;AACH,sBAAsB,sBAAsB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,yBAAyB;AACrC;AACA;AACA;AACA;AACA,yBAAyB,qBAAqB;AAC9C;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,2BAA2B;AACvC;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B,2BAA2B;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,YAAY,OAAO;AACnB;AACA;AACA;AACA,sDAAsD;AACtD;AACA,6DAA6D;;AAE7D;AACA;AACA;AACA;AACA,cAAc,uCAAuC;AACrD,KAAK;AACL,gDAAgD;AAChD,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc,wCAAwC;AACtD,KAAK;AACL,8CAA8C,mBAAmB;AACjE;AACA,GAAG;AACH,8CAA8C;AAC9C,2BAA2B,6BAA6B,mBAAmB;AAC3E;;AAEA;AACA;;AAEA,6BAA6B,qBAAqB;AAClD,kBAAkB,wBAAwB,mBAAmB;AAC7D,oBAAoB,8BAA8B;AAClD;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;;;;;;;AC/wCA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;ACpBA;;AAEA;AACA;AACA;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;;AAEA,CAAC;;;AAGD;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,aAAa,yBAAyB;AACtC;AACA;;AAEA;AACA;AACA;;AAEA,aAAa,sBAAsB;AACnC;AACA;;AAEA;AACA;;;AAGA;;AAEA,CAAC","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 69cc8c9169ad7f81980e","'use strict';\n\nlet map,\n\tmarkers = [],\n\tmarkerclusterer,\n\tactiveMarker,\n\tlastTouch = [],\n\tMarkerClusterer = require('node-js-marker-clusterer'),\n\tgoogle = null,\n\ttimeoutControlFade,\n\tinitialZoom = 4,\n\tinitialLatitude = 38.9284715,\n\tinitialLongitude = -97.5515638,\n\tcurrentState,\n\tcurrentCity;\n\nlet GoogleMapsLoader = require('google-maps');\nGoogleMapsLoader.KEY = 'AIzaSyD_C6GDv2SAhTGc2ijeomtQThYpS761PvU';\n\nconst fillSelect = (type, url) => {\n\tlet xhr = new XMLHttpRequest();\n\txhr.onload = () => {\n\t\tlet data = JSON.parse(xhr.responseText);\n\t\tlet select = document.querySelector('.gallery__select--' + type),\n\t\t\toption;\n\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\toption = data[i];\n\t\t\tselect.insertAdjacentHTML('beforeend', '<option data-id=\"' + option.pk + '\" value=\"' + JSON.stringify(option).split('\\\"').join('\\'') + '\">' + option.name + '</option>');\n\t\t}\n\t};\n\txhr.onerror = () => {\n\t  console.log('Error while getting ' + url + '.');\n\t};\n\txhr.open(\"GET\", url);\n\txhr.responseType = 'text';\n\txhr.send();\n};\n\nconst addMarkerCluster = () => {\n\tlet clusterStyles = [\n\t\t{\n\t\t\ttextColor: 'white',\n\t\t\turl: 'media/img/cluster-small.png',\n\t\t\theight: 42,\n\t\t\twidth: 42\n\t\t},\n\t\t{\n\t\t\ttextColor: 'white',\n\t\t\turl: 'media/img/cluster-medium.png',\n\t\t\theight: 54,\n\t\t\twidth: 54\n\t\t},\n\t\t{\n\t\t\ttextColor: 'white',\n\t\t\turl: 'media/img/cluster-large.png',\n\t\t\theight: 66,\n\t\t\twidth: 66\n\t\t}\n\t];\n\n\tlet mcOptions = {\n\t    gridSize: 66,\n\t    styles: clusterStyles,\n\t    maxZoom: 19\n\t};\n\n\tmarkerclusterer = new MarkerClusterer(map, markers, mcOptions);\n};\n\nconst changeImage = (direction) => {\n\tlet index = parseInt(document.querySelector('.gallery__image').dataset.id, 10),\n\t\tnewIndex = index;\n\n\tif (direction === 'prev') {\n\t\tnewIndex = (index > 0 ? index - 1 : markers.length-1);\n\t}\n\telse if (direction === 'next') {\n\t\tnewIndex = (index < markers.length - 1 ? index + 1 : 0);\n\t}\n\n\tif (index !== newIndex) {\n\t\tgoogle.maps.event.trigger(markers[newIndex], 'click');\n\t}\n};\n\nconst imageTouchStart = (event) => {\n\tlet timeStamp = event.timeStamp;\n\tif (event.changedTouches.length > 0) {\n\t\tevent = event.changedTouches[0];\n\t}\n\n\tlastTouch = [event.pageX, event.pageY, timeStamp];\n};\n\nconst imageTouchEnd = (event) => {\n\tif (lastTouch.length === 3) {\n\t\tlet timeStamp = event.timeStamp;\n\t\tif (event.changedTouches.length > 0) {\n\t\t\tevent = event.changedTouches[0];\n\t\t}\n\n\t\tlet distX = event.pageX - lastTouch[0],\n\t\t\ttimeDiff = timeStamp - lastTouch[2],\n\t\t\tminSwipe = 100;\n\n\t\tif (timeDiff < 1000) {\n\t\t\tif (distX < -1 * minSwipe) {\n\t\t\t\tchangeImage('next');\n\t\t\t}\n\t\t\telse if (distX > minSwipe) {\n\t\t\t\tchangeImage('prev');\n\t\t\t}\n\t\t}\n\t}\n\tlastTouch = [];\n};\n\nconst addMarkerClick = (marker, data) => {\n\tmarker.addListener('click', () => {\n\t\tdocument.querySelector('.gallery__content').classList.add('gallery__image-container');\n\t\tdocument.querySelector('.gallery__window').classList.remove('gallery__window--hidden');\n\n\t\tlet controls = document.querySelectorAll('.gallery__control');\n\t\tfor (let i in controls) {\n\t\t\tlet control = controls[i];\n\t\t\tif (control.classList) {\n\t\t\t\tcontrol.classList.remove('gallery--hidden');\n\t\t\t}\n\t\t}\n\n\t\tif (window.location.href.indexOf(':8000') > -1) {\n\t\t\tdocument.querySelector('.gallery__button--delete').classList.remove('gallery--hidden');\n\t\t}\n\t\telse {\n\t\t\tdocument.querySelector('.gallery__button--delete').classList.add('gallery--hidden');\n\t\t}\n\n\t\tif (marker.contentType === 'photo') {\n\t\t\tdocument.querySelector('.gallery__content').innerHTML = '<img class=\"gallery__image\" data-pk=\"' + data.pk + '\" data-id=\"' + marker.index + '\" src=\"' + marker.url + '\" />';\n\t\t}\n\t\telse {\n\t\t\tdocument.querySelector('.gallery__content').innerHTML = '<video controls autoplay class=\"gallery__image gallery__video\" data-pk=\"' + data.pk + '\" data-id=\"' + marker.index + '\" src=\"' + marker.url + '\" />';\n\t\t}\n\n\t\tlet galleryImage = document.querySelector('.gallery__image');\n\t\tgalleryImage.addEventListener('touchstart', imageTouchStart);\n\t\tgalleryImage.addEventListener('touchend', imageTouchEnd);\n\n\t\tdocument.querySelector('.gallery__image-caption-text').innerHTML = marker.description;\n\n\t\tactiveMarker = marker;\n\t\tmap.panTo(marker.position);\n\t\tdocument.querySelector('.gallery__navigation').classList.add('gallery--hidden');\n\n\t\tmap.setOptions({ keyboardShortcuts: false });\n\t});\n};\n\nconst fadeControls = () => {\n\twindow.clearTimeout(timeoutControlFade);\n\tlet controls = document.querySelectorAll('.gallery__control');\n\tfor (let i in controls) {\n\t\tlet control = controls[i];\n\t\tif (control.classList) {\n\t\t\tcontrol.classList.remove('gallery__control--fadeout');\n\t\t}\n\t}\n\ttimeoutControlFade = window.setTimeout(() => {\n\t\tfor (let i in controls) {\n\t\t\tlet control = controls[i];\n\t\t\tif (control.classList) {\n\t\t\t\tcontrol.classList.add('gallery__control--fadeout');\n\t\t\t}\n\t\t}\n\t}, 3000);\n};\n\nconst addMarkers = () => {\n\tlet xhr = new XMLHttpRequest();\n\txhr.onload = () => {\n\t\tlet placemarks = xhr.responseXML.documentElement.getElementsByTagName(\"Placemark\");\n\t\t[].forEach.call(placemarks, (element) =>{\n\t\t\t//get coordinates and place name\n\t\t\tlet url = element.getElementsByTagName('name')[0].textContent,\n\t\t\t\tdesc = element.getElementsByTagName('description')[0].textContent,\n\t\t\t\tdata = JSON.parse(desc);\n\n\t\t\tlet pos = new google.maps.LatLng(data.latitude, data.longitude),\n\t\t\t\ttitle = data.title;\n\n\t\t\tif (data.address && data.address.name !== data.title) {\n\t\t\t\ttitle += (title !== '' ? ', ' : '') + data.address.name;\n\t\t\t}\n\t\t\ttitle += (title !== '' ? '<br />' : '') + data.city.name + \", \" + data.state.name;\n\n\t\t\tlet contentType = (url.indexOf('.jpg') > -1 ? 'photo' : 'video');\n\n\t\t\tlet marker = new google.maps.Marker({\n\t\t\t\tindex: markers.length,\n\t\t\t\tposition: pos,\n\t\t\t\tcontentType: contentType,\n\t\t\t\tdescription: title,\n\t\t\t\tmap: map,\n\t\t\t\turl: url,\n\t\t\t\ttitle: data.title,\n\t\t\t\ticon: 'media/img/marker-' + contentType + '.png'\n\t\t\t});\n\n\t\t\taddMarkerClick(marker, data);\n\n\t\t\tmarkers.push(marker);\n\t\t});\n\t\taddMarkerCluster();\n\t};\n\txhr.onerror = () => {\n\t  console.log('Error while getting media/locations.kml.');\n\t};\n\txhr.open('GET', 'media/locations.kml');\n\txhr.responseType = 'document';\n\txhr.send();\n};\n\n//initialise a map\nconst init = () => {\n\tdocument.querySelector('.gallery__button--delete').classList.add('gallery--hidden');\n\tdocument.querySelector('.gallery__navigation').classList.add('gallery--hidden');\n\n\tlet latlng = new google.maps.LatLng(initialLatitude, initialLongitude),\n\t\tmyOptions = {\n\t\t\tzoom: initialZoom,\n\t\t\tcenter: latlng,\n\t\t\tmapTypeId: google.maps.MapTypeId.SATELLITE // HYBRID\n\t\t};\n\n\tmap = new google.maps.Map(document.getElementById('gallery__map'), myOptions);\n\n\tfillSelect('state', 'media/states.json');\n\tfillSelect('city', 'media/cities.json');\n\taddMarkers();\n};\n\nconst enterFullscreen = (element) => {\n\tif(element.requestFullscreen) {\n\t\telement.requestFullscreen();\n\t}\n\telse if(element.mozRequestFullScreen) {\n\t\telement.mozRequestFullScreen();\n\t}\n\telse if(element.webkitRequestFullscreen) {\n\t\telement.webkitRequestFullscreen();\n\t}\n\telse if(element.msRequestFullscreen) {\n\t\telement.msRequestFullscreen();\n\t}\n};\n\nconst exitFullscreen = () => {\n\tif(document.exitFullscreen) {\n\t\tdocument.exitFullscreen();\n\t}\n\telse if(document.mozCancelFullScreen) {\n\t\tdocument.mozCancelFullScreen();\n\t}\n\telse if(document.webkitExitFullscreen) {\n\t\tdocument.webkitExitFullscreen();\n\t}\n};\n\nconst getCookie = (name) => {\n\tlet cookieValue = null;\n\tif (document.cookie && document.cookie !== '') {\n\t\tlet cookies = document.cookie.split(';');\n\t\tfor (let i = 0; i < cookies.length; i++) {\n\t\t\tlet cookie = cookies[i].trim();\n\t\t\t// Does this cookie string begin with the name we want?\n\t\t\tif (cookie.substring(0, name.length + 1) === (name + '=')) {\n\t\t\t\tcookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn cookieValue;\n};\n\n//bind events for close button\ndocument.querySelector('[data-button=\"fullscreen\"]').addEventListener('click', (event) => {\n\tif (event.currentTarget.classList.contains('gallery__button--fullscreen')) {\n\t\tenterFullscreen(document.querySelector('.gallery__window'));\n\t}\n\telse {\n\t\texitFullscreen();\n\t}\n});\n\n//bind events for close button\ndocument.querySelector('[data-button=\"close\"]').addEventListener('click', () =>{\n\texitFullscreen();\n\tdocument.querySelector('.gallery__control').classList.add('gallery--hidden');\n\tdocument.querySelector('.gallery__window').classList.add('gallery__window--hidden');\n\tdocument.querySelector('.gallery__content').classList.remove('gallery__image-container');\n\tdocument.querySelector('.gallery__navigation').classList.remove('gallery--hidden');\n\n\tmap.setOptions({ keyboardShortcuts: true });\n\tdocument.getElementById('gallery__map').focus();\n});\n\n//bind events for prev / next buttons\nlet buttons = document.querySelectorAll('.gallery__image-caption .gallery__button');\nfor (let i in buttons) {\n\tlet button = buttons[i];\n\tconsole.log(button);\n\tif (button.addEventListener) {\n\t\tbutton.addEventListener('click', (event) => {\n\t\t\tchangeImage(event.currentTarget.dataset.button);\n\t\t});\n\t}\n}\n\n//bind events for delete buttons\ndocument.querySelector('[data-button=\"delete\"]').addEventListener('click', () => {\n\tif (window.confirm('Willst du dieses Bild wirklich löschen?')) {\n\t\tlet csrftoken = getCookie('csrftoken'),\n\t\t\tid = document.querySelector('.gallery__window .gallery__image').dataset.pk;\n\n\t\tif (!isNaN(parseInt(id, 10))) {\n\t\t\tlet xhr = new XMLHttpRequest();\n\t\t\txhr.onload = () => {\n\t\t\t\twindow.alert('Bild ' + id + ' wurde gelöscht, wechsle zum nächsten...');\n\t\t\t\tchangeImage('next');\n\t\t\t};\n\t\t\txhr.onerror = () => {\n\t\t\t\twindow.alert('Bild konnte nicht gelöscht werden: ID nicht lesbar.');\n\t\t\t};\n\t\t\txhr.open('DELETE', '/api/images/' + id + '/');\n\t\t\txhr.responseType = \"text\";\n\t\t\txhr.setRequestHeader(\"X-CSRFToken\", csrftoken);\n\t\t\txhr.send();\n\t\t}\n\t\telse {\n\t\t}\n\t}\n});\n\nlet selects = document.querySelectorAll('.gallery__select');\nfor (let i = 0; i < selects.length; i++) {\n\tlet select = selects[i];\n\tselect.addEventListener('change', (event) => {\n\t\ttry {\n\t\t\tlet data = JSON.parse(event.currentTarget.options[event.currentTarget.selectedIndex].value.split('\\'').join('\\\"'));\n\t\t\tif (data.state) {\n\t\t\t\tdocument.querySelector('.gallery__select--state [data-id=\"' + data.state.pk + '\"]').selected = true;\n\t\t\t\tdocument.querySelector('.gallery__select--state').dispatchEvent(new Event('change'));\n\t\t\t\tcurrentCity = data.pk;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet cities = document.querySelectorAll('.gallery__select--city [data-id]');\n\t\t\t\tfor (let i = 0; i < cities.length; i++) {\n\t\t\t\t\tlet city = cities[i];\n\t\t\t\t\tif (city && city.value) {\n\t\t\t\t\t\tlet cityData = JSON.parse(city.value.split('\\'').join('\\\"'));\n\t\t\t\t\t\tif (cityData.state.pk === data.pk) {\n\t\t\t\t\t\t\tcity.style.display = 'block';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcity.style.display = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (currentState !== data.pk) {\n\t\t\t\t\tdocument.querySelector('.gallery__select--city').selectedIndex = 0;\n\t\t\t\t\tcurrentState = data.pk;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet sw = new google.maps.LatLng(data.max_latitude, data.max_longitude);\n\t\t\tlet ne = new google.maps.LatLng(data.min_latitude, data.min_longitude);\n\t\t\tnew google.maps.LatLngBounds();\n\t\t\tlet bounds = new google.maps.LatLngBounds();\n\t\t\tbounds.extend(sw);\n\t\t\tbounds.extend(ne);\n\t\t\tmap.fitBounds(bounds);\n\t\t}\n\t\tcatch (e) {\n\t\t\tif (event.currentTarget.classList.contains('gallery__select--state')) {\n\t\t\t\tlet cities = document.querySelectorAll('.gallery__select--city [data-id]');\n\t\t\t\tfor (let i = 0; i < cities.length; i++) {\n\t\t\t\t\tlet city = cities[i];\n\t\t\t\t\tcity.style.display = 'block';\n\t\t\t\t}\n\t\t\t\tdocument.querySelector('.gallery__select--city').selectedIndex = 0;\n\t\t\t\tmap.setCenter(new google.maps.LatLng(initialLatitude, initialLongitude));\n\t\t\t\tmap.setZoom(initialZoom);\n\t\t\t\tcurrentState = -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdocument.querySelector('.gallery__select--state').dispatchEvent(new Event('change'));\n\t\t\t}\n\t\t}\n\t});\n}\n\ndocument.addEventListener('keyup', (event) => {\n\tif (document.querySelectorAll('.gallery__window--hidden').length <= 0 && document.querySelectorAll('.gallery__image').length > 0 ) {\n\t\tif (event.keyCode === 37) { // left\n\t\t\tchangeImage('prev');\n\t\t} else if (event.keyCode === 39) { // right\n\t\t\tchangeImage('next');\n\t\t}\n\t}\n\n\tif (event.keyCode === 27) { // escape\n\t\tif (!document.querySelector('.gallery__window').classList.contains('gallery--fullscreen')) {\n\t\t\tdocument.querySelector('[data-button=\"close\"]').dispatchEvent(new Event('click'));\n\t\t}\n\t}\n});\n\nconst fullScreenChange = () => {\n\tif (!document.querySelector('.gallery__window').classList.contains('gallery--fullscreen')) {\n\t\tdocument.querySelector('.gallery__window').classList.add('gallery--fullscreen');\n\t\tdocument.querySelector('[data-button=\"fullscreen\"]').classList.remove('gallery__button--fullscreen');\n\t\tdocument.querySelector('[data-button=\"fullscreen\"]').classList.add('gallery__button--windowed');\n\t}\n\telse {\n\t\tdocument.querySelector('.gallery__window').classList.remove('gallery--fullscreen');\n\t\tdocument.querySelector('[data-button=\"fullscreen\"]').classList.remove('gallery__button--windowed');\n\t\tdocument.querySelector('[data-button=\"fullscreen\"]').classList.add('gallery__button--fullscreen');\n\t}\n};\n\ndocument.addEventListener('fullscreenchange', fullScreenChange);\ndocument.addEventListener('mozfullscreenchange', fullScreenChange);\ndocument.addEventListener('webkitfullscreenchange', fullScreenChange);\ndocument.addEventListener('MSFullscreenChange', fullScreenChange);\n\ndocument.addEventListener('mousemove', fadeControls);\ndocument.addEventListener('keyup', fadeControls);\ndocument.addEventListener('click', fadeControls);\n\nGoogleMapsLoader.load((g) => {\n\tgoogle = g;\n\tinit();\n});\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/main.js","/**\n * Npm version of markerClusterer works great with browserify and google maps for commonjs\n * https://www.npmjs.com/package/googlemaps\n * Difference from the original - adds a commonjs format and replaces window with global and some unit test\n * The original functionality it's not modified for docs and original source check\n * https://github.com/googlemaps/js-marker-clusterer\n */\n\n/**\n * @name MarkerClusterer for Google Maps v3\n * @version version 1.0\n * @author Luke Mahe\n * @fileoverview\n * The library creates and manages per-zoom-level clusters for large amounts of\n * markers.\n * <br/>\n * This is a v3 implementation of the\n * <a href=\"http://gmaps-utility-library-dev.googlecode.com/svn/tags/markerclusterer/\"\n * >v2 MarkerClusterer</a>.\n */\n\n/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * A Marker Clusterer that clusters markers.\n *\n * @param {google.maps.Map} map The Google map to attach to.\n * @param {Array.<google.maps.Marker>=} opt_markers Optional markers to add to\n *   the cluster.\n * @param {Object=} opt_options support the following options:\n *     'gridSize': (number) The grid size of a cluster in pixels.\n *     'maxZoom': (number) The maximum zoom level that a marker can be part of a\n *                cluster.\n *     'zoomOnClick': (boolean) Whether the default behaviour of clicking on a\n *                    cluster is to zoom into it.\n *     'averageCenter': (boolean) Wether the center of each cluster should be\n *                      the average of all markers in the cluster.\n *     'minimumClusterSize': (number) The minimum number of markers to be in a\n *                           cluster before the markers are hidden and a count\n *                           is shown.\n *     'styles': (object) An object that has style properties:\n *       'url': (string) The image url.\n *       'height': (number) The image height.\n *       'width': (number) The image width.\n *       'anchor': (Array) The anchor position of the label text.\n *       'textColor': (string) The text color.\n *       'textSize': (number) The text size.\n *       'backgroundPosition': (string) The position of the backgound x, y.\n * @constructor\n * @extends google.maps.OverlayView\n */\nfunction MarkerClusterer(map, opt_markers, opt_options) {\n  // MarkerClusterer implements google.maps.OverlayView interface. We use the\n  // extend function to extend MarkerClusterer with google.maps.OverlayView\n  // because it might not always be available when the code is defined so we\n  // look for it at the last possible moment. If it doesn't exist now then\n  // there is no point going ahead :)\n  this.extend(MarkerClusterer, google.maps.OverlayView);\n  this.map_ = map;\n\n  /**\n   * @type {Array.<google.maps.Marker>}\n   * @private\n   */\n  this.markers_ = [];\n\n  /**\n   *  @type {Array.<Cluster>}\n   */\n  this.clusters_ = [];\n\n  this.sizes = [53, 56, 66, 78, 90];\n\n  /**\n   * @private\n   */\n  this.styles_ = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.ready_ = false;\n\n  var options = opt_options || {};\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.gridSize_ = options['gridSize'] || 60;\n\n  /**\n   * @private\n   */\n  this.minClusterSize_ = options['minimumClusterSize'] || 2;\n\n\n  /**\n   * @type {?number}\n   * @private\n   */\n  this.maxZoom_ = options['maxZoom'] || null;\n\n  this.styles_ = options['styles'] || [];\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.imagePath_ = options['imagePath'] ||\n      this.MARKER_CLUSTER_IMAGE_PATH_;\n\n  /**\n   * @type {string}\n   * @private\n   */\n  this.imageExtension_ = options['imageExtension'] ||\n      this.MARKER_CLUSTER_IMAGE_EXTENSION_;\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.zoomOnClick_ = true;\n\n  if (options['zoomOnClick'] != undefined) {\n    this.zoomOnClick_ = options['zoomOnClick'];\n  }\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this.averageCenter_ = false;\n\n  if (options['averageCenter'] != undefined) {\n    this.averageCenter_ = options['averageCenter'];\n  }\n\n  this.setupStyles_();\n\n  this.setMap(map);\n\n  /**\n   * @type {number}\n   * @private\n   */\n  this.prevZoom_ = this.map_.getZoom();\n\n  // Add the map event listeners\n  var that = this;\n  google.maps.event.addListener(this.map_, 'zoom_changed', function() {\n    var zoom = that.map_.getZoom();\n\n    if (that.prevZoom_ != zoom) {\n      that.prevZoom_ = zoom;\n      that.resetViewport();\n    }\n  });\n\n  google.maps.event.addListener(this.map_, 'idle', function() {\n    that.redraw();\n  });\n\n  // Finally, add the markers\n  if (opt_markers && opt_markers.length) {\n    this.addMarkers(opt_markers, false);\n  }\n}\n\n\n/**\n * The marker cluster image path.\n *\n * @type {string}\n * @private\n */\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_PATH_ =\n    'http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/' +\n    'images/m';\n\n\n/**\n * The marker cluster image path.\n *\n * @type {string}\n * @private\n */\nMarkerClusterer.prototype.MARKER_CLUSTER_IMAGE_EXTENSION_ = 'png';\n\n\n/**\n * Extends a objects prototype by anothers.\n *\n * @param {Object} obj1 The object to be extended.\n * @param {Object} obj2 The object to extend with.\n * @return {Object} The new extended object.\n * @ignore\n */\nMarkerClusterer.prototype.extend = function(obj1, obj2) {\n  return (function(object) {\n    for (var property in object.prototype) {\n      this.prototype[property] = object.prototype[property];\n    }\n    return this;\n  }).apply(obj1, [obj2]);\n};\n\n\n/**\n * Implementaion of the interface method.\n * @ignore\n */\nMarkerClusterer.prototype.onAdd = function() {\n  this.setReady_(true);\n};\n\n/**\n * Implementaion of the interface method.\n * @ignore\n */\nMarkerClusterer.prototype.draw = function() {};\n\n/**\n * Sets up the styles object.\n *\n * @private\n */\nMarkerClusterer.prototype.setupStyles_ = function() {\n  if (this.styles_.length) {\n    return;\n  }\n\n  for (var i = 0, size; size = this.sizes[i]; i++) {\n    this.styles_.push({\n      url: this.imagePath_ + (i + 1) + '.' + this.imageExtension_,\n      height: size,\n      width: size\n    });\n  }\n};\n\n/**\n *  Fit the map to the bounds of the markers in the clusterer.\n */\nMarkerClusterer.prototype.fitMapToMarkers = function() {\n  var markers = this.getMarkers();\n  var bounds = new google.maps.LatLngBounds();\n  for (var i = 0, marker; marker = markers[i]; i++) {\n    bounds.extend(marker.getPosition());\n  }\n\n  this.map_.fitBounds(bounds);\n};\n\n\n/**\n *  Sets the styles.\n *\n *  @param {Object} styles The style to set.\n */\nMarkerClusterer.prototype.setStyles = function(styles) {\n  this.styles_ = styles;\n};\n\n\n/**\n *  Gets the styles.\n *\n *  @return {Object} The styles object.\n */\nMarkerClusterer.prototype.getStyles = function() {\n  return this.styles_;\n};\n\n\n/**\n * Whether zoom on click is set.\n *\n * @return {boolean} True if zoomOnClick_ is set.\n */\nMarkerClusterer.prototype.isZoomOnClick = function() {\n  return this.zoomOnClick_;\n};\n\n/**\n * Whether average center is set.\n *\n * @return {boolean} True if averageCenter_ is set.\n */\nMarkerClusterer.prototype.isAverageCenter = function() {\n  return this.averageCenter_;\n};\n\n\n/**\n *  Returns the array of markers in the clusterer.\n *\n *  @return {Array.<google.maps.Marker>} The markers.\n */\nMarkerClusterer.prototype.getMarkers = function() {\n  return this.markers_;\n};\n\n\n/**\n *  Returns the number of markers in the clusterer\n *\n *  @return {Number} The number of markers.\n */\nMarkerClusterer.prototype.getTotalMarkers = function() {\n  return this.markers_.length;\n};\n\n\n/**\n *  Sets the max zoom for the clusterer.\n *\n *  @param {number} maxZoom The max zoom level.\n */\nMarkerClusterer.prototype.setMaxZoom = function(maxZoom) {\n  this.maxZoom_ = maxZoom;\n};\n\n\n/**\n *  Gets the max zoom for the clusterer.\n *\n *  @return {number} The max zoom level.\n */\nMarkerClusterer.prototype.getMaxZoom = function() {\n  return this.maxZoom_;\n};\n\n\n/**\n *  The function for calculating the cluster icon image.\n *\n *  @param {Array.<google.maps.Marker>} markers The markers in the clusterer.\n *  @param {number} numStyles The number of styles available.\n *  @return {Object} A object properties: 'text' (string) and 'index' (number).\n *  @private\n */\nMarkerClusterer.prototype.calculator_ = function(markers, numStyles) {\n  var index = 0;\n  var count = markers.length;\n  var dv = count;\n  while (dv !== 0) {\n    dv = parseInt(dv / 10, 10);\n    index++;\n  }\n\n  index = Math.min(index, numStyles);\n  return {\n    text: count,\n    index: index\n  };\n};\n\n\n/**\n * Set the calculator function.\n *\n * @param {function(Array, number)} calculator The function to set as the\n *     calculator. The function should return a object properties:\n *     'text' (string) and 'index' (number).\n *\n */\nMarkerClusterer.prototype.setCalculator = function(calculator) {\n  this.calculator_ = calculator;\n};\n\n\n/**\n * Get the calculator function.\n *\n * @return {function(Array, number)} the calculator function.\n */\nMarkerClusterer.prototype.getCalculator = function() {\n  return this.calculator_;\n};\n\n\n/**\n * Add an array of markers to the clusterer.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to add.\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\n */\nMarkerClusterer.prototype.addMarkers = function(markers, opt_nodraw) {\n  for (var i = 0, marker; marker = markers[i]; i++) {\n    this.pushMarkerTo_(marker);\n  }\n  if (!opt_nodraw) {\n    this.redraw();\n  }\n};\n\n\n/**\n * Pushes a marker to the clusterer.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @private\n */\nMarkerClusterer.prototype.pushMarkerTo_ = function(marker) {\n  marker.isAdded = false;\n  if (marker['draggable']) {\n    // If the marker is draggable add a listener so we update the clusters on\n    // the drag end.\n    var that = this;\n    google.maps.event.addListener(marker, 'dragend', function() {\n      marker.isAdded = false;\n      that.repaint();\n    });\n  }\n  this.markers_.push(marker);\n};\n\n\n/**\n * Adds a marker to the clusterer and redraws if needed.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @param {boolean=} opt_nodraw Whether to redraw the clusters.\n */\nMarkerClusterer.prototype.addMarker = function(marker, opt_nodraw) {\n  this.pushMarkerTo_(marker);\n  if (!opt_nodraw) {\n    this.redraw();\n  }\n};\n\n\n/**\n * Removes a marker and returns true if removed, false if not\n *\n * @param {google.maps.Marker} marker The marker to remove\n * @return {boolean} Whether the marker was removed or not\n * @private\n */\nMarkerClusterer.prototype.removeMarker_ = function(marker) {\n  var index = -1;\n  if (this.markers_.indexOf) {\n    index = this.markers_.indexOf(marker);\n  } else {\n    for (var i = 0, m; m = this.markers_[i]; i++) {\n      if (m == marker) {\n        index = i;\n        break;\n      }\n    }\n  }\n\n  if (index == -1) {\n    // Marker is not in our list of markers.\n    return false;\n  }\n\n  marker.setMap(null);\n\n  this.markers_.splice(index, 1);\n\n  return true;\n};\n\n\n/**\n * Remove a marker from the cluster.\n *\n * @param {google.maps.Marker} marker The marker to remove.\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\n * @return {boolean} True if the marker was removed.\n */\nMarkerClusterer.prototype.removeMarker = function(marker, opt_nodraw) {\n  var removed = this.removeMarker_(marker);\n\n  if (!opt_nodraw && removed) {\n    this.resetViewport();\n    this.redraw();\n    return true;\n  } else {\n   return false;\n  }\n};\n\n\n/**\n * Removes an array of markers from the cluster.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to remove.\n * @param {boolean=} opt_nodraw Optional boolean to force no redraw.\n */\nMarkerClusterer.prototype.removeMarkers = function(markers, opt_nodraw) {\n  var removed = false;\n\n  for (var i = 0, marker; marker = markers[i]; i++) {\n    var r = this.removeMarker_(marker);\n    removed = removed || r;\n  }\n\n  if (!opt_nodraw && removed) {\n    this.resetViewport();\n    this.redraw();\n    return true;\n  }\n};\n\n\n/**\n * Sets the clusterer's ready state.\n *\n * @param {boolean} ready The state.\n * @private\n */\nMarkerClusterer.prototype.setReady_ = function(ready) {\n  if (!this.ready_) {\n    this.ready_ = ready;\n    this.createClusters_();\n  }\n};\n\n\n/**\n * Returns the number of clusters in the clusterer.\n *\n * @return {number} The number of clusters.\n */\nMarkerClusterer.prototype.getTotalClusters = function() {\n  return this.clusters_.length;\n};\n\n\n/**\n * Returns the google map that the clusterer is associated with.\n *\n * @return {google.maps.Map} The map.\n */\nMarkerClusterer.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Sets the google map that the clusterer is associated with.\n *\n * @param {google.maps.Map} map The map.\n */\nMarkerClusterer.prototype.setMap = function(map) {\n  this.map_ = map;\n};\n\n\n/**\n * Returns the size of the grid.\n *\n * @return {number} The grid size.\n */\nMarkerClusterer.prototype.getGridSize = function() {\n  return this.gridSize_;\n};\n\n\n/**\n * Sets the size of the grid.\n *\n * @param {number} size The grid size.\n */\nMarkerClusterer.prototype.setGridSize = function(size) {\n  this.gridSize_ = size;\n};\n\n\n/**\n * Returns the min cluster size.\n *\n * @return {number} The grid size.\n */\nMarkerClusterer.prototype.getMinClusterSize = function() {\n  return this.minClusterSize_;\n};\n\n/**\n * Sets the min cluster size.\n *\n * @param {number} size The grid size.\n */\nMarkerClusterer.prototype.setMinClusterSize = function(size) {\n  this.minClusterSize_ = size;\n};\n\n\n/**\n * Extends a bounds object by the grid size.\n *\n * @param {google.maps.LatLngBounds} bounds The bounds to extend.\n * @return {google.maps.LatLngBounds} The extended bounds.\n */\nMarkerClusterer.prototype.getExtendedBounds = function(bounds) {\n  var projection = this.getProjection();\n\n  // Turn the bounds into latlng.\n  var tr = new google.maps.LatLng(bounds.getNorthEast().lat(),\n      bounds.getNorthEast().lng());\n  var bl = new google.maps.LatLng(bounds.getSouthWest().lat(),\n      bounds.getSouthWest().lng());\n\n  // Convert the points to pixels and the extend out by the grid size.\n  var trPix = projection.fromLatLngToDivPixel(tr);\n  trPix.x += this.gridSize_;\n  trPix.y -= this.gridSize_;\n\n  var blPix = projection.fromLatLngToDivPixel(bl);\n  blPix.x -= this.gridSize_;\n  blPix.y += this.gridSize_;\n\n  // Convert the pixel points back to LatLng\n  var ne = projection.fromDivPixelToLatLng(trPix);\n  var sw = projection.fromDivPixelToLatLng(blPix);\n\n  // Extend the bounds to contain the new bounds.\n  bounds.extend(ne);\n  bounds.extend(sw);\n\n  return bounds;\n};\n\n\n/**\n * Determins if a marker is contained in a bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @param {google.maps.LatLngBounds} bounds The bounds to check against.\n * @return {boolean} True if the marker is in the bounds.\n * @private\n */\nMarkerClusterer.prototype.isMarkerInBounds_ = function(marker, bounds) {\n  return bounds.contains(marker.getPosition());\n};\n\n\n/**\n * Clears all clusters and markers from the clusterer.\n */\nMarkerClusterer.prototype.clearMarkers = function() {\n  this.resetViewport(true);\n\n  // Set the markers a empty array.\n  this.markers_ = [];\n};\n\n\n/**\n * Clears all existing clusters and recreates them.\n * @param {boolean} opt_hide To also hide the marker.\n */\nMarkerClusterer.prototype.resetViewport = function(opt_hide) {\n  // Remove all the clusters\n  for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\n    cluster.remove();\n  }\n\n  // Reset the markers to not be added and to be invisible.\n  for (var i = 0, marker; marker = this.markers_[i]; i++) {\n    marker.isAdded = false;\n    if (opt_hide) {\n      marker.setMap(null);\n    }\n  }\n\n  this.clusters_ = [];\n};\n\n/**\n *\n */\nMarkerClusterer.prototype.repaint = function() {\n  var oldClusters = this.clusters_.slice();\n  this.clusters_.length = 0;\n  this.resetViewport();\n  this.redraw();\n\n  // Remove the old clusters.\n  // Do it in a timeout so the other clusters have been drawn first.\n  window.setTimeout(function() {\n    for (var i = 0, cluster; cluster = oldClusters[i]; i++) {\n      cluster.remove();\n    }\n  }, 0);\n};\n\n\n/**\n * Redraws the clusters.\n */\nMarkerClusterer.prototype.redraw = function() {\n  this.createClusters_();\n};\n\n\n/**\n * Calculates the distance between two latlng locations in km.\n * @see http://www.movable-type.co.uk/scripts/latlong.html\n *\n * @param {google.maps.LatLng} p1 The first lat lng point.\n * @param {google.maps.LatLng} p2 The second lat lng point.\n * @return {number} The distance between the two points in km.\n * @private\n*/\nMarkerClusterer.prototype.distanceBetweenPoints_ = function(p1, p2) {\n  if (!p1 || !p2) {\n    return 0;\n  }\n\n  var R = 6371; // Radius of the Earth in km\n  var dLat = (p2.lat() - p1.lat()) * Math.PI / 180;\n  var dLon = (p2.lng() - p1.lng()) * Math.PI / 180;\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(p1.lat() * Math.PI / 180) * Math.cos(p2.lat() * Math.PI / 180) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  var d = R * c;\n  return d;\n};\n\n\n/**\n * Add a marker to a cluster, or creates a new cluster.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @private\n */\nMarkerClusterer.prototype.addToClosestCluster_ = function(marker) {\n  var distance = 40000; // Some large number\n  var clusterToAddTo = null;\n  var pos = marker.getPosition();\n  for (var i = 0, cluster; cluster = this.clusters_[i]; i++) {\n    var center = cluster.getCenter();\n    if (center) {\n      var d = this.distanceBetweenPoints_(center, marker.getPosition());\n      if (d < distance) {\n        distance = d;\n        clusterToAddTo = cluster;\n      }\n    }\n  }\n\n  if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\n    clusterToAddTo.addMarker(marker);\n  } else {\n    var cluster = new Cluster(this);\n    cluster.addMarker(marker);\n    this.clusters_.push(cluster);\n  }\n};\n\n\n/**\n * Creates the clusters.\n *\n * @private\n */\nMarkerClusterer.prototype.createClusters_ = function() {\n  if (!this.ready_) {\n    return;\n  }\n\n  // Get our current map view bounds.\n  // Create a new bounds object so we don't affect the map.\n  var mapBounds = new google.maps.LatLngBounds(this.map_.getBounds().getSouthWest(),\n      this.map_.getBounds().getNorthEast());\n  var bounds = this.getExtendedBounds(mapBounds);\n\n  for (var i = 0, marker; marker = this.markers_[i]; i++) {\n    if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\n      this.addToClosestCluster_(marker);\n    }\n  }\n};\n\n\n/**\n * A cluster that contains markers.\n *\n * @param {MarkerClusterer} markerClusterer The markerclusterer that this\n *     cluster is associated with.\n * @constructor\n * @ignore\n */\nfunction Cluster(markerClusterer) {\n  this.markerClusterer_ = markerClusterer;\n  this.map_ = markerClusterer.getMap();\n  this.gridSize_ = markerClusterer.getGridSize();\n  this.minClusterSize_ = markerClusterer.getMinClusterSize();\n  this.averageCenter_ = markerClusterer.isAverageCenter();\n  this.center_ = null;\n  this.markers_ = [];\n  this.bounds_ = null;\n  this.clusterIcon_ = new ClusterIcon(this, markerClusterer.getStyles(),\n      markerClusterer.getGridSize());\n}\n\n/**\n * Determins if a marker is already added to the cluster.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker is already added.\n */\nCluster.prototype.isMarkerAlreadyAdded = function(marker) {\n  if (this.markers_.indexOf) {\n    return this.markers_.indexOf(marker) != -1;\n  } else {\n    for (var i = 0, m; m = this.markers_[i]; i++) {\n      if (m == marker) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * Add a marker the cluster.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @return {boolean} True if the marker was added.\n */\nCluster.prototype.addMarker = function(marker) {\n  if (this.isMarkerAlreadyAdded(marker)) {\n    return false;\n  }\n\n  if (!this.center_) {\n    this.center_ = marker.getPosition();\n    this.calculateBounds_();\n  } else {\n    if (this.averageCenter_) {\n      var l = this.markers_.length + 1;\n      var lat = (this.center_.lat() * (l-1) + marker.getPosition().lat()) / l;\n      var lng = (this.center_.lng() * (l-1) + marker.getPosition().lng()) / l;\n      this.center_ = new google.maps.LatLng(lat, lng);\n      this.calculateBounds_();\n    }\n  }\n\n  marker.isAdded = true;\n  this.markers_.push(marker);\n\n  var len = this.markers_.length;\n  if (len < this.minClusterSize_ && marker.getMap() != this.map_) {\n    // Min cluster size not reached so show the marker.\n    marker.setMap(this.map_);\n  }\n\n  if (len == this.minClusterSize_) {\n    // Hide the markers that were showing.\n    for (var i = 0; i < len; i++) {\n      this.markers_[i].setMap(null);\n    }\n  }\n\n  if (len >= this.minClusterSize_) {\n    marker.setMap(null);\n  }\n\n  this.updateIcon();\n  return true;\n};\n\n\n/**\n * Returns the marker clusterer that the cluster is associated with.\n *\n * @return {MarkerClusterer} The associated marker clusterer.\n */\nCluster.prototype.getMarkerClusterer = function() {\n  return this.markerClusterer_;\n};\n\n\n/**\n * Returns the bounds of the cluster.\n *\n * @return {google.maps.LatLngBounds} the cluster bounds.\n */\nCluster.prototype.getBounds = function() {\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n  var markers = this.getMarkers();\n  for (var i = 0, marker; marker = markers[i]; i++) {\n    bounds.extend(marker.getPosition());\n  }\n  return bounds;\n};\n\n\n/**\n * Removes the cluster\n */\nCluster.prototype.remove = function() {\n  this.clusterIcon_.remove();\n  this.markers_.length = 0;\n  delete this.markers_;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {number} The cluster center.\n */\nCluster.prototype.getSize = function() {\n  return this.markers_.length;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {Array.<google.maps.Marker>} The cluster center.\n */\nCluster.prototype.getMarkers = function() {\n  return this.markers_;\n};\n\n\n/**\n * Returns the center of the cluster.\n *\n * @return {google.maps.LatLng} The cluster center.\n */\nCluster.prototype.getCenter = function() {\n  return this.center_;\n};\n\n\n/**\n * Calculated the extended bounds of the cluster with the grid.\n *\n * @private\n */\nCluster.prototype.calculateBounds_ = function() {\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n  this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\n};\n\n\n/**\n * Determines if a marker lies in the clusters bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker lies in the bounds.\n */\nCluster.prototype.isMarkerInClusterBounds = function(marker) {\n  return this.bounds_.contains(marker.getPosition());\n};\n\n\n/**\n * Returns the map that the cluster is associated with.\n *\n * @return {google.maps.Map} The map.\n */\nCluster.prototype.getMap = function() {\n  return this.map_;\n};\n\n\n/**\n * Updates the cluster icon\n */\nCluster.prototype.updateIcon = function() {\n  var zoom = this.map_.getZoom();\n  var mz = this.markerClusterer_.getMaxZoom();\n\n  if (mz && zoom > mz) {\n    // The zoom is greater than our max zoom so show all the markers in cluster.\n    for (var i = 0, marker; marker = this.markers_[i]; i++) {\n      marker.setMap(this.map_);\n    }\n    return;\n  }\n\n  if (this.markers_.length < this.minClusterSize_) {\n    // Min cluster size not yet reached.\n    this.clusterIcon_.hide();\n    return;\n  }\n\n  var numStyles = this.markerClusterer_.getStyles().length;\n  var sums = this.markerClusterer_.getCalculator()(this.markers_, numStyles);\n  this.clusterIcon_.setCenter(this.center_);\n  this.clusterIcon_.setSums(sums);\n  this.clusterIcon_.show();\n};\n\n\n/**\n * A cluster icon\n *\n * @param {Cluster} cluster The cluster to be associated with.\n * @param {Object} styles An object that has style properties:\n *     'url': (string) The image url.\n *     'height': (number) The image height.\n *     'width': (number) The image width.\n *     'anchor': (Array) The anchor position of the label text.\n *     'textColor': (string) The text color.\n *     'textSize': (number) The text size.\n *     'backgroundPosition: (string) The background postition x, y.\n * @param {number=} opt_padding Optional padding to apply to the cluster icon.\n * @constructor\n * @extends google.maps.OverlayView\n * @ignore\n */\nfunction ClusterIcon(cluster, styles, opt_padding) {\n  cluster.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView);\n\n  this.styles_ = styles;\n  this.padding_ = opt_padding || 0;\n  this.cluster_ = cluster;\n  this.center_ = null;\n  this.map_ = cluster.getMap();\n  this.div_ = null;\n  this.sums_ = null;\n  this.visible_ = false;\n\n  this.setMap(this.map_);\n}\n\n\n/**\n * Triggers the clusterclick event and zoom's if the option is set.\n */\nClusterIcon.prototype.triggerClusterClick = function() {\n  var markerClusterer = this.cluster_.getMarkerClusterer();\n\n  // Trigger the clusterclick event.\n  google.maps.event.trigger(markerClusterer, 'clusterclick', this.cluster_);\n\n  if (markerClusterer.isZoomOnClick()) {\n    // Zoom into the cluster.\n    this.map_.fitBounds(this.cluster_.getBounds());\n  }\n};\n\n\n/**\n * Adding the cluster icon to the dom.\n * @ignore\n */\nClusterIcon.prototype.onAdd = function() {\n  this.div_ = document.createElement('DIV');\n  if (this.visible_) {\n    var pos = this.getPosFromLatLng_(this.center_);\n    this.div_.style.cssText = this.createCss(pos);\n    this.div_.innerHTML = this.sums_.text;\n  }\n\n  var panes = this.getPanes();\n  panes.overlayMouseTarget.appendChild(this.div_);\n\n  var that = this;\n  google.maps.event.addDomListener(this.div_, 'click', function() {\n    that.triggerClusterClick();\n  });\n};\n\n\n/**\n * Returns the position to place the div dending on the latlng.\n *\n * @param {google.maps.LatLng} latlng The position in latlng.\n * @return {google.maps.Point} The position in pixels.\n * @private\n */\nClusterIcon.prototype.getPosFromLatLng_ = function(latlng) {\n  var pos = this.getProjection().fromLatLngToDivPixel(latlng);\n  pos.x -= parseInt(this.width_ / 2, 10);\n  pos.y -= parseInt(this.height_ / 2, 10);\n  return pos;\n};\n\n\n/**\n * Draw the icon.\n * @ignore\n */\nClusterIcon.prototype.draw = function() {\n  if (this.visible_) {\n    var pos = this.getPosFromLatLng_(this.center_);\n    this.div_.style.top = pos.y + 'px';\n    this.div_.style.left = pos.x + 'px';\n  }\n};\n\n\n/**\n * Hide the icon.\n */\nClusterIcon.prototype.hide = function() {\n  if (this.div_) {\n    this.div_.style.display = 'none';\n  }\n  this.visible_ = false;\n};\n\n\n/**\n * Position and show the icon.\n */\nClusterIcon.prototype.show = function() {\n  if (this.div_) {\n    var pos = this.getPosFromLatLng_(this.center_);\n    this.div_.style.cssText = this.createCss(pos);\n    this.div_.style.display = '';\n  }\n  this.visible_ = true;\n};\n\n\n/**\n * Remove the icon from the map\n */\nClusterIcon.prototype.remove = function() {\n  this.setMap(null);\n};\n\n\n/**\n * Implementation of the onRemove interface.\n * @ignore\n */\nClusterIcon.prototype.onRemove = function() {\n  if (this.div_ && this.div_.parentNode) {\n    this.hide();\n    this.div_.parentNode.removeChild(this.div_);\n    this.div_ = null;\n  }\n};\n\n\n/**\n * Set the sums of the icon.\n *\n * @param {Object} sums The sums containing:\n *   'text': (string) The text to display in the icon.\n *   'index': (number) The style index of the icon.\n */\nClusterIcon.prototype.setSums = function(sums) {\n  this.sums_ = sums;\n  this.text_ = sums.text;\n  this.index_ = sums.index;\n  if (this.div_) {\n    this.div_.innerHTML = sums.text;\n  }\n\n  this.useStyle();\n};\n\n\n/**\n * Sets the icon to the the styles.\n */\nClusterIcon.prototype.useStyle = function() {\n  var index = Math.max(0, this.sums_.index - 1);\n  index = Math.min(this.styles_.length - 1, index);\n  var style = this.styles_[index];\n  this.url_ = style['url'];\n  this.height_ = style['height'];\n  this.width_ = style['width'];\n  this.textColor_ = style['textColor'];\n  this.anchor_ = style['anchor'];\n  this.textSize_ = style['textSize'];\n  this.backgroundPosition_ = style['backgroundPosition'];\n};\n\n\n/**\n * Sets the center of the icon.\n *\n * @param {google.maps.LatLng} center The latlng to set as the center.\n */\nClusterIcon.prototype.setCenter = function(center) {\n  this.center_ = center;\n};\n\n\n/**\n * Create the css text based on the position of the icon.\n *\n * @param {google.maps.Point} pos The position.\n * @return {string} The css style text.\n */\nClusterIcon.prototype.createCss = function(pos) {\n  var style = [];\n  style.push('background-image:url(' + this.url_ + ');');\n  var backgroundPosition = this.backgroundPosition_ ? this.backgroundPosition_ : '0 0';\n  style.push('background-position:' + backgroundPosition + ';');\n\n  if (typeof this.anchor_ === 'object') {\n    if (typeof this.anchor_[0] === 'number' && this.anchor_[0] > 0 &&\n        this.anchor_[0] < this.height_) {\n      style.push('height:' + (this.height_ - this.anchor_[0]) +\n          'px; padding-top:' + this.anchor_[0] + 'px;');\n    } else {\n      style.push('height:' + this.height_ + 'px; line-height:' + this.height_ +\n          'px;');\n    }\n    if (typeof this.anchor_[1] === 'number' && this.anchor_[1] > 0 &&\n        this.anchor_[1] < this.width_) {\n      style.push('width:' + (this.width_ - this.anchor_[1]) +\n          'px; padding-left:' + this.anchor_[1] + 'px;');\n    } else {\n      style.push('width:' + this.width_ + 'px; text-align:center;');\n    }\n  } else {\n    style.push('height:' + this.height_ + 'px; line-height:' +\n        this.height_ + 'px; width:' + this.width_ + 'px; text-align:center;');\n  }\n\n  var txtColor = this.textColor_ ? this.textColor_ : 'black';\n  var txtSize = this.textSize_ ? this.textSize_ : 11;\n\n  style.push('cursor:pointer; top:' + pos.y + 'px; left:' +\n      pos.x + 'px; color:' + txtColor + '; position:absolute; font-size:' +\n      txtSize + 'px; font-family:Arial,sans-serif; font-weight:bold');\n  return style.join('');\n};\n\n\n// Export Symbols for Closure\n// If you are not going to compile with closure then you can remove the\n// code below.\nglobal['MarkerClusterer'] = MarkerClusterer;\nMarkerClusterer.prototype['addMarker'] = MarkerClusterer.prototype.addMarker;\nMarkerClusterer.prototype['addMarkers'] = MarkerClusterer.prototype.addMarkers;\nMarkerClusterer.prototype['clearMarkers'] =\n    MarkerClusterer.prototype.clearMarkers;\nMarkerClusterer.prototype['fitMapToMarkers'] =\n    MarkerClusterer.prototype.fitMapToMarkers;\nMarkerClusterer.prototype['getCalculator'] =\n    MarkerClusterer.prototype.getCalculator;\nMarkerClusterer.prototype['getGridSize'] =\n    MarkerClusterer.prototype.getGridSize;\nMarkerClusterer.prototype['getExtendedBounds'] =\n    MarkerClusterer.prototype.getExtendedBounds;\nMarkerClusterer.prototype['getMap'] = MarkerClusterer.prototype.getMap;\nMarkerClusterer.prototype['getMarkers'] = MarkerClusterer.prototype.getMarkers;\nMarkerClusterer.prototype['getMaxZoom'] = MarkerClusterer.prototype.getMaxZoom;\nMarkerClusterer.prototype['getStyles'] = MarkerClusterer.prototype.getStyles;\nMarkerClusterer.prototype['getTotalClusters'] =\n    MarkerClusterer.prototype.getTotalClusters;\nMarkerClusterer.prototype['getTotalMarkers'] =\n    MarkerClusterer.prototype.getTotalMarkers;\nMarkerClusterer.prototype['redraw'] = MarkerClusterer.prototype.redraw;\nMarkerClusterer.prototype['removeMarker'] =\n    MarkerClusterer.prototype.removeMarker;\nMarkerClusterer.prototype['removeMarkers'] =\n    MarkerClusterer.prototype.removeMarkers;\nMarkerClusterer.prototype['resetViewport'] =\n    MarkerClusterer.prototype.resetViewport;\nMarkerClusterer.prototype['repaint'] =\n    MarkerClusterer.prototype.repaint;\nMarkerClusterer.prototype['setCalculator'] =\n    MarkerClusterer.prototype.setCalculator;\nMarkerClusterer.prototype['setGridSize'] =\n    MarkerClusterer.prototype.setGridSize;\nMarkerClusterer.prototype['setMaxZoom'] =\n    MarkerClusterer.prototype.setMaxZoom;\nMarkerClusterer.prototype['onAdd'] = MarkerClusterer.prototype.onAdd;\nMarkerClusterer.prototype['draw'] = MarkerClusterer.prototype.draw;\n\nCluster.prototype['getCenter'] = Cluster.prototype.getCenter;\nCluster.prototype['getSize'] = Cluster.prototype.getSize;\nCluster.prototype['getMarkers'] = Cluster.prototype.getMarkers;\n\nClusterIcon.prototype['onAdd'] = ClusterIcon.prototype.onAdd;\nClusterIcon.prototype['draw'] = ClusterIcon.prototype.draw;\nClusterIcon.prototype['onRemove'] = ClusterIcon.prototype.onRemove;\n\n\nmodule.exports = MarkerClusterer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/node-js-marker-clusterer/src/markerclusterer.js\n// module id = 2\n// module chunks = 0","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 3\n// module chunks = 0","(function(root, factory) {\n\n\tif (root === null) {\n\t\tthrow new Error('Google-maps package can be used only in browser');\n\t}\n\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t} else if (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t} else {\n\t\troot.GoogleMapsLoader = factory();\n\t}\n\n})(typeof window !== 'undefined' ? window : null, function() {\n\n\n\t'use strict';\n\n\n\tvar googleVersion = '3.18';\n\n\tvar script = null;\n\n\tvar google = null;\n\n\tvar loading = false;\n\n\tvar callbacks = [];\n\n\tvar onLoadEvents = [];\n\n\tvar originalCreateLoaderMethod = null;\n\n\n\tvar GoogleMapsLoader = {};\n\n\n\tGoogleMapsLoader.URL = 'https://maps.googleapis.com/maps/api/js';\n\n\tGoogleMapsLoader.KEY = null;\n\n\tGoogleMapsLoader.LIBRARIES = [];\n\n\tGoogleMapsLoader.CLIENT = null;\n\n\tGoogleMapsLoader.CHANNEL = null;\n\n\tGoogleMapsLoader.LANGUAGE = null;\n\n\tGoogleMapsLoader.REGION = null;\n\n\tGoogleMapsLoader.VERSION = googleVersion;\n\n\tGoogleMapsLoader.WINDOW_CALLBACK_NAME = '__google_maps_api_provider_initializator__';\n\n\n\tGoogleMapsLoader._googleMockApiObject = {};\n\n\n\tGoogleMapsLoader.load = function(fn) {\n\t\tif (google === null) {\n\t\t\tif (loading === true) {\n\t\t\t\tif (fn) {\n\t\t\t\t\tcallbacks.push(fn);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tloading = true;\n\n\t\t\t\twindow[GoogleMapsLoader.WINDOW_CALLBACK_NAME] = function() {\n\t\t\t\t\tready(fn);\n\t\t\t\t};\n\n\t\t\t\tGoogleMapsLoader.createLoader();\n\t\t\t}\n\t\t} else if (fn) {\n\t\t\tfn(google);\n\t\t}\n\t};\n\n\n\tGoogleMapsLoader.createLoader = function() {\n\t\tscript = document.createElement('script');\n\t\tscript.type = 'text/javascript';\n\t\tscript.src = GoogleMapsLoader.createUrl();\n\n\t\tdocument.body.appendChild(script);\n\t};\n\n\n\tGoogleMapsLoader.isLoaded = function() {\n\t\treturn google !== null;\n\t};\n\n\n\tGoogleMapsLoader.createUrl = function() {\n\t\tvar url = GoogleMapsLoader.URL;\n\n\t\turl += '?callback=' + GoogleMapsLoader.WINDOW_CALLBACK_NAME;\n\n\t\tif (GoogleMapsLoader.KEY) {\n\t\t\turl += '&key=' + GoogleMapsLoader.KEY;\n\t\t}\n\n\t\tif (GoogleMapsLoader.LIBRARIES.length > 0) {\n\t\t\turl += '&libraries=' + GoogleMapsLoader.LIBRARIES.join(',');\n\t\t}\n\n\t\tif (GoogleMapsLoader.CLIENT) {\n\t\t\turl += '&client=' + GoogleMapsLoader.CLIENT + '&v=' + GoogleMapsLoader.VERSION;\n\t\t}\n\n\t\tif (GoogleMapsLoader.CHANNEL) {\n\t\t\turl += '&channel=' + GoogleMapsLoader.CHANNEL;\n\t\t}\n\n\t\tif (GoogleMapsLoader.LANGUAGE) {\n\t\t\turl += '&language=' + GoogleMapsLoader.LANGUAGE;\n\t\t}\n\n\t\tif (GoogleMapsLoader.REGION) {\n\t\t\turl += '&region=' + GoogleMapsLoader.REGION;\n\t\t}\n\n\t\treturn url;\n\t};\n\n\n\tGoogleMapsLoader.release = function(fn) {\n\t\tvar release = function() {\n\t\t\tGoogleMapsLoader.KEY = null;\n\t\t\tGoogleMapsLoader.LIBRARIES = [];\n\t\t\tGoogleMapsLoader.CLIENT = null;\n\t\t\tGoogleMapsLoader.CHANNEL = null;\n\t\t\tGoogleMapsLoader.LANGUAGE = null;\n\t\t\tGoogleMapsLoader.REGION = null;\n\t\t\tGoogleMapsLoader.VERSION = googleVersion;\n\n\t\t\tgoogle = null;\n\t\t\tloading = false;\n\t\t\tcallbacks = [];\n\t\t\tonLoadEvents = [];\n\n\t\t\tif (typeof window.google !== 'undefined') {\n\t\t\t\tdelete window.google;\n\t\t\t}\n\n\t\t\tif (typeof window[GoogleMapsLoader.WINDOW_CALLBACK_NAME] !== 'undefined') {\n\t\t\t\tdelete window[GoogleMapsLoader.WINDOW_CALLBACK_NAME];\n\t\t\t}\n\n\t\t\tif (originalCreateLoaderMethod !== null) {\n\t\t\t\tGoogleMapsLoader.createLoader = originalCreateLoaderMethod;\n\t\t\t\toriginalCreateLoaderMethod = null;\n\t\t\t}\n\n\t\t\tif (script !== null) {\n\t\t\t\tscript.parentElement.removeChild(script);\n\t\t\t\tscript = null;\n\t\t\t}\n\n\t\t\tif (fn) {\n\t\t\t\tfn();\n\t\t\t}\n\t\t};\n\n\t\tif (loading) {\n\t\t\tGoogleMapsLoader.load(function() {\n\t\t\t\trelease();\n\t\t\t});\n\t\t} else {\n\t\t\trelease();\n\t\t}\n\t};\n\n\n\tGoogleMapsLoader.onLoad = function(fn) {\n\t\tonLoadEvents.push(fn);\n\t};\n\n\n\tGoogleMapsLoader.makeMock = function() {\n\t\toriginalCreateLoaderMethod = GoogleMapsLoader.createLoader;\n\n\t\tGoogleMapsLoader.createLoader = function() {\n\t\t\twindow.google = GoogleMapsLoader._googleMockApiObject;\n\t\t\twindow[GoogleMapsLoader.WINDOW_CALLBACK_NAME]();\n\t\t};\n\t};\n\n\n\tvar ready = function(fn) {\n\t\tvar i;\n\n\t\tloading = false;\n\n\t\tif (google === null) {\n\t\t\tgoogle = window.google;\n\t\t}\n\n\t\tfor (i = 0; i < onLoadEvents.length; i++) {\n\t\t\tonLoadEvents[i](google);\n\t\t}\n\n\t\tif (fn) {\n\t\t\tfn(google);\n\t\t}\n\n\t\tfor (i = 0; i < callbacks.length; i++) {\n\t\t\tcallbacks[i](google);\n\t\t}\n\n\t\tcallbacks = [];\n\t};\n\n\n\treturn GoogleMapsLoader;\n\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/google-maps/lib/Google.js\n// module id = 4\n// module chunks = 0"],"sourceRoot":""}